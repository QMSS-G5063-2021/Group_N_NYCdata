---
title: "NYC Sanitation and Rat Sightings "
author: "Pratishta Yerakala"
date: "4/14/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Download all necessary libraries 
library(ggplot2)    # the king of plotting 
library(magrittr)   # chain operators, e.g. to "pipe" a value forward
library(plyr)
library(dplyr) 
library(tidyverse)
library(DT)
library(knitr)
library(maps)
library(rgdal)
library(ggmap)
library(tmap)
library(sp)
```


```{r, layout="l-body-outset"}
# read in the main csv file
rat_data<-read.csv("sanitation_data/rat_data.csv")

rat_data <- rat_data %>%
  mutate(Borough = str_to_title(rat_data$Borough))

tonnage_data<-read.csv("sanitation_data/dsny_tonnage.csv", stringsAsFactors = FALSE)


head(rat_data)
head(tonnage_data)
```
```{r}
rat_borough <- rat_data %>% 
  group_by(Borough) %>%
  tally()

rat_borough
```


```{r}
ton_boro <- tonnage_data %>%
  group_by(BOROUGH) %>%
  summarise(total_ton = sum(REFUSETONSCOLLECTED))

ton_boro
```

```{r}
rat_ton <- left_join(rat_borough, ton_boro, by = c("Borough" = "BOROUGH"))
rat_ton
```
```{r}
rat <- ggplot(rat_ton, aes(y=n, x=Borough)) + 
    geom_bar(position="dodge", stat="identity")
rat
```
```{r}
ton <- ggplot(rat_ton, aes(y=total_ton, x=Borough)) + 
    geom_bar(position="dodge", stat="identity")
ton
```

```{r}
nyc <- readOGR("sanitation_data/DSNYSections/.", "geo_export_c0459e49-70dc-4fa8-a3fc-c3d366dedd05")
```
```{r}
nyc_sp <- spTransform(nyc, CRS("+proj=longlat +datum=WGS84"))
```
```{r}
nyc_sp@data
```
```{r}
# tm_shape(nyc_sp) +
# tm_fill("section", title = "Number of Tickets")
```
```{r}
plot(nyc_sp)
```

