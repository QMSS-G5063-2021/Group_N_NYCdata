---
title: "brendan2"
author: "Brendan Mapes"
date: "4/17/2021"
output: html_document
---

```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggthemes)
library(gridExtra)
library(dplyr)
library(plotly)


open <- read.csv("Open_Restaurant_Applications.csv")
inspection <- read.csv("DOHMH_New_York_City_Restaurant_Inspection_Results.csv")
rat_311 <- read.csv("311_Service_Requests_from_2010_to_Present.csv")


restaurant_borough <- count(open, Borough)
names(restaurant_borough)[names(restaurant_borough) == "n"] <- "count"
rat_borough <- count(rat_311, Borough)
borough <- c("Bronx", "Brooklyn", "Manhattan", "Queens", "Staten Island", "none")
rat_borough <- cbind(rat_borough, borough) %>% filter(borough!= "none")
rat_borough <- select(rat_borough, borough, n)
names(rat_borough)[names(rat_borough) == "n"] <- "count"
names(rat_borough)[names(rat_borough) == "borough"] <- "Borough"

inspection_bc <- inspection %>% filter(GRADE == "B" | GRADE == "C")
inspection_count_2020 <- count(inspection_bc, BORO)
names(inspection_count_2020)[names(inspection_count_2020) == "n"] <- "count"
names(inspection_count_2020)[names(inspection_count_2020) == "BORO"] <- "Borough"


street_seating <- filter(open, Approved.for.Roadway.Seating == "yes")
count_street <- count(street_seating, Borough)
names(count_street)[names(count_street) == "n"] <- "count"

sidewalk_seating <- filter(open, Approved.for.Sidewalk.Seating == "yes")
count_sidewalk <- count(sidewalk_seating, Borough)
names(count_sidewalk)[names(count_sidewalk) == "n"] <- "count"


plot1 <- ggplot() + geom_bar(data=rat_borough, aes(x=Borough, y=count, fill=Borough), stat="identity") + ggtitle("2020 rodent reports") + ylab("Number of 311 calls\n") + xlab("\nBorough") + theme_light() + theme(plot.title=element_text(face="bold"), axis.title.x=element_text(face="bold"), axis.title.y=element_text(face="bold"), legend.position="none") +  theme(axis.text.x = element_text(angle = 40, vjust=.7)) 


plot2 <- ggplot() + geom_bar(data=restaurant_borough, aes(x =Borough, y= count, fill =Borough), stat="identity") + ggtitle("Outdoor restaurants") + ylab("Applications approved\n") + xlab("\nBorough") + theme_light() + theme(plot.title=element_text(face="bold"), axis.title.x=element_text(face="bold"), legend.position="none", axis.title.y=element_text(face="bold")) + theme(axis.text.x = element_text(angle = 40, vjust=.7))

plot3 <- ggplot() + geom_bar(data=inspection_count_2020, aes(x=Borough, y=count, fill=Borough), stat="identity") + ggtitle("Restaurants w/ B or C inspection scores") + ylab("Restaurants\n") + xlab("\nBorough") + theme_light() + theme(plot.title=element_text(face="bold"), axis.title.x=element_text(face="bold"), legend.position="none", axis.title.y=element_text(face="bold")) +  theme(axis.text.x = element_text(angle = 40, vjust=.7))


plot4 <- ggplot() + geom_bar(data=count_street, aes(x=Borough, y=count, fill=Borough), stat="identity") + ggtitle("Street dining") + ylab("Approved restaurants\n") + xlab("\nBorough") + theme_light() + theme(plot.title=element_text(face="bold"), axis.title.x=element_text(face="bold"), axis.title.y=element_text(face="bold"), legend.position="none") +  theme(axis.text.x = element_text(angle = 40, vjust=.7))

plot5 <- ggplot() + geom_bar(data=count_sidewalk, aes(x=Borough, y=count, fill=Borough), stat="identity") + ggtitle("Sidewalk dining") + ylab("Approved restaurants\n") + xlab("\nBorough") + theme_light() + theme(plot.title=element_text(face="bold"), axis.title.x=element_text(face="bold"), axis.title.y=element_text(face="bold"), legend.position="none") +  theme(axis.text.x = element_text(angle = 40, vjust=.7))



plot1a <- ggplotly(plot1, tooltip=c("x", "y"))

plot2a <- ggplotly(plot2, tooltip=c("x", "y"))

plot3a <- ggplotly(plot3, tooltip=c("x", "y"))

plot4a <- ggplotly(plot4, tooltip=c("x", "y"))

plot5a <- ggplotly(plot5, tooltip=c("x", "y"))

plot1a
plot2a
plot3a
plot4a
plot5a

```
